# Development

When you're ready to implement Functions within your Juno Satellite, you'll have a variety of event-driven macros at your disposal, enabling custom logic execution in response to specific actions. Here's how to implement each available Function:

---

## Hooks

Hooks allow you to define event-driven logic that responds to specific actions within your Satellite. The following is a list of available hooks and their respective use cases.

### on_set_doc

import OnSetDoc from "./components/on-set-doc.mdx";

<OnSetDoc />

### on_set_many_docs

import OnSetManyDocs from "./components/on-set-many-docs.mdx";

<OnSetManyDocs />

### on_delete_doc

import OnDeleteDoc from "./components/on-delete-doc.mdx";

<OnDeleteDoc />

### on_delete_many_docs

import OnDeleteManyDocs from "./components/on-delete-many-docs.mdx";

<OnDeleteManyDocs />

### on_delete_filtered_docs

import OnDeleteFilteredDocs from "./components/on-delete-filtered-docs.mdx";

<OnDeleteFilteredDocs />

### on_upload_asset

import OnUploadAsset from "./components/on-upload-asset.mdx";

<OnUploadAsset />

### on_delete_asset

import OnDeleteAsset from "./components/on-delete-asset.mdx";

<OnDeleteAsset />

### on_delete_many_assets

import OnDeleteManyAssets from "./components/on-delete-many-assets.mdx";

<OnDeleteManyAssets />

### on_delete_filtered_assets

import OnDeleteFilteredAssets from "./components/on-delete-filtered-assets.mdx";

<OnDeleteFilteredAssets />

### on_init

Called during the initialization of the satellite. This hook is invoked when the satellite is first deployed and can be used to set up initial configurations or resources.

```rust
#[on_init]
fn on_init() -> Result<(), String> {
    // Custom logic for initialization
    Ok(())
}
```

Unlike datastore or storage hooks, `on_init` cannot be scoped to specific collections or assets, as it is meant to handle global initialization logic.

This feature is not enabled by default. To use it, you’ll need to opt in by updating your `Cargo.toml` file.

```toml
[dependencies]
junobuild-satellite = { version = "*", features = ["default", "on_init"] }
```

### on_post_upgrade

Invoked after the satellite has been upgraded to a new version. This hook is typically used to manage migration tasks, or starting custom processes like timers.

```rust
#[on_post_upgrade]
fn on_post_upgrade() -> Result<(), String> {
    // Custom logic for post-upgrade tasks
    Ok(())
}
```

Similar to `on_init`, the `on_post_upgrade` hook cannot be scoped to collections or assets. It operates globally to handle upgrade-related operations.

This feature is not enabled by default. To use it, you’ll need to opt in by updating your `Cargo.toml` file.

```toml
[dependencies]
junobuild-satellite = { version = "*", features = ["default", "on_post_upgrade"] }
```

---

## Assertions

Assertions enable validation checks before specific actions are executed within your Satellite. The following is a list of available assertions and their functionalities.

### assert_set_doc

Ensures a document can be created or updated.

```rust
#[assert_set_doc]
fn assert_set_doc(_context: AssertSetDocContext) -> Result<(), String> {
    // Custom logic for asserting a document's creation or update is possible
    Ok(())
}
```

### assert_delete_doc

Verifies that a document can be deleted.

```rust
#[assert_delete_doc]
fn assert_delete_doc(context: AssertDeleteDocContext) -> Result<(), String> {
    // Custom logic for asserting a document can be deleted
    Ok(())
}
```

### assert_upload_asset

Confirms an asset upload can be committed.

```rust
#[assert_upload_asset]
fn assert_upload_asset(_context: AssertUploadAssetContext) -> Result<(), String> {
    // Custom logic for asserting an asset upload is possible
    Ok(())
}
```

### assert_delete_asset

Checks that an asset can be deleted.

```rust
#[assert_delete_asset]
fn assert_delete_asset(_context: AssertDeleteAssetContext) -> Result<(), String> {
    // Custom logic for asserting an asset can be deleted
    Ok(())
}
```

---

## When the Functions Run

import Collections from "./components/collections.mdx";

<Collections />

---

## Including the Satellite

After defining your Functions, at the very end of your `lib.rs` module, include the Satellite to ensure that your custom logic and the default features or Juno are properly registered and executable within the Juno ecosystem.

:::important

This is crucial for compatibility with the Juno Console and CLI, as it expects the Satellite to expose the necessary functionality for monitoring, deployment, and interaction. Without this macro, certain features in the Console may not function correctly.

:::

```rust
include_satellite!();
```

---

## Feature Selection

When you run `juno dev eject`, all the available hooks and assertions are scaffolded in your `lib.rs` module. However, if you don’t have to implement all of them for example to improve readability or reduce unnecessary logic, you can selectively enable only the features you need.

To do this, disable the default features in your `Cargo.toml` and explicitly specify only the ones you want to use.

For example, if you only need `on_set_doc` and `assert_set_doc`, configure your `Cargo.toml` like this:

```toml
[dependencies]
junobuild-satellite = { version = "0.0.21", default-features = false, features = ["on_set_doc", "assert_set_doc"] }
```

With this setup, only `on_set_doc` and `assert_set_doc` must be implemented with custom logic, while other hooks and assertions will not be included in your Satellite.

---

## Additional Notes

WebAssembly (Wasm) binaries serve as the compilation target for the Satellites. While Juno's CLI automatically specifies this target for you, manual execution of certain `cargo` commands necessitates explicitly providing this target.

For instance:

```bash
cargo clippy --target=wasm32-unknown-unknown
```

---

## Further Resources

For more in-depth explanations and real-world implementations, check out the [Examples](../../guides/rust.mdx) page, which showcases practical use cases and provides sample projects available on GitHub.
